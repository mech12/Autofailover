
<!-- jQuery 2.1.3 -->
<script src="plugins/jQuery/jQuery-2.1.3.min.js"></script>
<!-- jQuery UI 1.11.2 -->
<script src="http://code.jquery.com/ui/1.11.2/jquery-ui.min.js" type="text/javascript"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
	$.widget.bridge('uibutton', $.ui.button);
</script>
<!-- Bootstrap 3.3.2 JS -->
<script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>    
<!-- Morris.js charts -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="plugins/morris/morris.min.js" type="text/javascript"></script>
<!-- Sparkline -->
<script src="plugins/sparkline/jquery.sparkline.min.js" type="text/javascript"></script>
<!-- jvectormap -->
<script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js" type="text/javascript"></script>
<script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js" type="text/javascript"></script>
<!-- jQuery Knob Chart -->
<script src="plugins/knob/jquery.knob.js" type="text/javascript"></script>
<!-- daterangepicker -->
<script src="plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>
<!-- datepicker -->
<script src="plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>
<!-- Bootstrap WYSIHTML5 -->
<script src="plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js" type="text/javascript"></script>
<!-- iCheck -->
<script src="plugins/iCheck/icheck.min.js" type="text/javascript"></script>
<!-- Slimscroll -->
<script src="plugins/slimScroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<!-- FastClick -->
<script src='plugins/fastclick/fastclick.min.js'></script>
<!-- AdminLTE App -->
<script src="dist/js/app.min.js" type="text/javascript"></script>

<link rel="stylesheet" type="text/css" href="btn/css/demo.css" />
<link rel="stylesheet" type="text/css" href="btn/css/style5.css" />

<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js" type="text/javascript"></script>

<!--[if IE]><script type="text/javascript" src="excanvas.js"></script><![endif]-->
<!-- <script type="text/javascript" src="canvas.js"></script> -->
<script type="text/javascript" src="canvas_af_g_G.js"></script>
<script type="text/javascript" src="canvas_af_util.js"></script>
<script type="text/javascript" src="canvas_af.js"></script>



<script>
	function change_btn_status(id_name,ret)
	{
		if(ret[id_name]['error'] == null)
			$('#btn_id_' + id_name).css('border' , '');
		else
			$('#btn_id_' + id_name).css('border' , '2px solid red');
	}
	
	function update_ui_status(ret)
	{
		change_btn_status('db' , ret);
		change_btn_status('app' , ret);
		change_btn_status('vip1' , ret);
		change_btn_status('vip2' , ret);
		change_btn_status('disk1' , ret);
		change_btn_status('disk2' , ret);
		change_btn_status('server1' , ret);
		change_btn_status('server2' , ret);
	}

    window.setInterval(function(){
        $.ajax({
            url:'/index.php/welcome/check_status',
            data:$('#setting_form').serialize(),
            dataType:'json',
            success:function(ret){

                if(ret.error)
                {
                    $('#status').css('color','red').html(ret.error);
                }
                else
                {
					update_ui_status(ret);
                    $('#status').css('color','black').html('check_status' + JSON.stringify(ret));
                    console.dir(ret);
                    window.setTimeout(function(){
                        $('#status').css('color','black').html('');
                    }, 5000);
                }
            },
            error:function(xhr , exception){
                ajax_error(xhr, exception);
            }
        });

    }, 5100);

	
	$( ".sidebar-menu" ).keyup(function( event ) 
	{
		var t = event.target;
		//console.log(t.id, t.value  );
		var btn_id = '#btn_'+t.id;
		var btn_info = find_btn_info(btn_id);
		$(btn_id).val(btn_info.nic + ': ' +  t.value);
		element_movetoV(g_G,btn_id,btn_info.x, btn_info.y);
		
		if(t.id =='id_server1' || t.id =='id_server2')
		{
			return;
		}
		if(t.id =='id_vip1' || t.id =='id_vip2')
		{
			return;
		}
		if(t.id =='id_disk1' || t.id =='id_disk2')
		{
			return;
		}
		if(t.id =='id_db')
		{
			return;
		}
		if(t.id =='id_app')
		{
			return;
		}

	});

    $('#save_setting').click(function(){

        $.ajax({
            url:'./',
            data:$('#setting_form').serialize(),
            dataType:'json',
            success:function(ret){

                if(ret.error)
                {
                    $('#status').css('color','red').html(ret.error);
                }
                else
                {
                    $('#status').css('color','black').html('save ok : ' + JSON.stringify(ret));
                    window.setTimeout(function(){
                        $('#status').css('color','black').html('');
                    }, 5000);
                }
            },
            error:function(xhr , exception){
                ajax_error(xhr, exception);
            }
        })
    })


    function ajax_error(jqXHR, exception) {
        if (jqXHR.status === 0) {
            $('#status').css('color','red').html('Not connect.\n Verify Network.');
        } else if (jqXHR.status == 404) {
            $('#status').css('color','red').html('Requested page not found. [404]');
        } else if (jqXHR.status == 500) {
            $('#status').css('color','red').html('Internal Server Error [500].');
        } else if (exception === 'parsererror') {
            $('#status').css('color','red').html('Requested JSON parse failed.');
        } else if (exception === 'timeout') {
            $('#status').css('color','red').html('Time out error.');
        } else if (exception === 'abort') {
            $('#status').css('color','red').html('Ajax request aborted.');
        } else {
            $('#status').css('color','red').html('Uncaught Error.\n' + jqXHR.responseText);
        }
    }

</script>